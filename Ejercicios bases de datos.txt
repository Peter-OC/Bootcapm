--1
SELECT *
FROM actor
WHERE first_name = 'NICK'

--2
SELECT district 
FROM address 
WHERE district IS NOT NULL
ORDER BY district

--3
SELECT *
FROM film
WHERE description LIKE '%Secret Agent%'

--4
SELECT *
FROM film
WHERE rental_duration 
ORDER BY rental_duration DESC

--5
SELECT customer_id, AVG(amount) AS Total
FROM payment
GROUP BY customer_id
HAVING COUNT(amount) <25 AND SUM(amount)>100
ORDER BY Total DESC 

--6
SELECT first_name, COUNT(first_name) AS Total
FROM actor
GROUP BY first_name
ORDER BY 2 DESC LIMIT 5

--7
SELECT cu.first_name, cu.last_name, cu.email, ad.address, ad.postal_code, ci.city, co.country
FROM customer AS cu
	INNER JOIN address AS ad
	INNER JOIN city AS ci
	INNER JOIN country AS co
	ON ci.country_id = co.country_id
	ON ad.city_id = ci.city_id
	ON cu.address_id = ci.city_id	
WHERE co.country LIKE 'china' OR co.country LIKE 'Taiwan'

--8
SELECT ci.city, co.country, s.store_id, s.first_name, s.last_name, 
	COUNT(inv.film_id), 
	COUNT(DISTINCT inv.film_id), 
	COUNT(DISTINCT cus.store_id)
FROM staff AS s
INNER JOIN
(address AS a INNER JOIN city 
	AS ci INNER JOIN country 
	AS co ON ci.country_id = co.country_id ON a.city_id = ci.city_id)
	ON s.address_id = a.address_id
INNER JOIN inventory AS inv ON s.store_id = inv.store_id
INNER JOIN customer AS cus ON s.store_id = cus.store_id
GROUP BY s.staff_id

--9
-- En este me ayudo Alberto porue no entendia como solucionar la consulta

SELECT r.rental_id, fT.title Titulo, r.rental_date 'Fecha de alquiler', 
r.return_date 'Fecha de devolcuion', DATEDIFF(r.return_date,r.rental_date) AS 'Tiempo Transcurrido', 
cus.first_name 'Nombre de Cliente', cus.last_name 'Apellido de Cliente', 
sta.first_name 'Nombre Trabajador', sta.last_name 'Apellido Trabajador', 
ci.city 'Ciudad de la tienda', co.country 'Pais de la tienda'
FROM rental AS r
	INNER JOIN
		(staff AS sta 
		INNER JOIN address AS a 
			ON a.address_id = sta.address_id
		INNER JOIN city AS ci 
			ON a.city_id = ci.city_id 
		INNER JOIN country AS co 
			ON ci.country_id = co.country_id 	
		)
		ON r.staff_id = sta.staff_id
	INNER JOIN inventory AS inv
		ON inv.inventory_id = r.inventory_id 
	INNER JOIN film_text AS fT 
		ON fT.film_id = inv.film_id 	
	INNER JOIN customer AS cus 
		ON r.customer_id = cus.customer_id
GROUP BY r.rental_id

--10
SELECT r.rental_id, fT.title Titulo, r.rental_date 'Fecha de alquiler', 
r.return_date 'Fecha de devolcuion', DATEDIFF(CURRENT_DATE,r.rental_date)+' dias' AS tiempoAlquilado, 
cus.first_name 'Nombre de Cliente', cus.last_name 'Apellido de Cliente', a.phone 'Tel√©fono'
FROM rental AS r
	INNER JOIN
		(staff AS sta 
		INNER JOIN address AS a 
			ON a.address_id = sta.address_id)
		ON r.staff_id = sta.staff_id
		
	INNER JOIN city AS ci
		ON a.city_id = ci.city_id 
	INNER JOIN country AS co 
		ON ci.country_id = co.country_id 			
	INNER JOIN inventory AS inv 
		ON inv.inventory_id = r.inventory_id
	INNER JOIN film_text AS fT 
		ON fT.film_id = inv.film_id 	
	INNER JOIN customer AS cus 
		ON r.customer_id = cus.customer_id
GROUP BY r.rental_id
HAVING r.return_date IS NULL
ORDER BY tiempoAlquilado DESC, cus.first_name

--11
SELECT co.country, 
	COUNT(re.rental_id) AS rental_count,
	RANK() OVER (ORDER BY COUNT(re.rental_id) DESC) AS 'RANKING'
FROM rental re
	INNER JOIN customer cu 
		ON (re.customer_id = cu.customer_id)
	INNER JOIN address a 
		ON (cu.address_id = a.address_id )
	INNER JOIN city ci
		ON (a.city_id = ci.city_id)
	INNER JOIN country co
		ON (ci.country_id = co.country_id)
	INNER JOIN inventory i
		ON (re.inventory_id = i.inventory_id)
	INNER JOIN film_actor fa
		ON (i.film_id = fa.film_id)
	INNER JOIN actor ac
		ON (fa.actor_id = ac.actor_id)
WHERE ac.first_name = 'GINA' AND ac.last_name = 'DEGENERES'
GROUP BY co.country
ORDER BY rental_count DESC

--1
SELECT *
FROM actor
WHERE first_name = 'NICK'
--2
SELECT district 
FROM address 
WHERE district IS NOT NULL
ORDER BY district
--3
SELECT *
FROM film
WHERE description LIKE '%Secret Agent%'
--4
SELECT *
FROM film
WHERE rental_duration 
ORDER BY rental_duration DESC
--5

--6
SELECT first_name, COUNT(first_name) AS total
FROM actor
GROUP BY first_name
ORDER BY 2 DESC LIMIT 5
--7
SELECT cu.first_name, cu.last_name, cu.email, ad.address, ad.postal_code, ci.city, co.country
FROM customer AS cu
	INNER JOIN address AS ad
	INNER JOIN city AS ci
	INNER JOIN country AS co
	ON ci.country_id = co.country_id
	ON ad.city_id = ci.city_id
	ON cu.address_id = ci.city_id	
WHERE co.country LIKE 'china' OR co.country LIKE 'Taiwan'
--8
SELECT ci.city, co.country, s.store_id, s.first_name, s.last_name, 
	COUNT(inv.film_id), 
	COUNT(DISTINCT inv.film_id), 
	COUNT(DISTINCT cus.store_id)
FROM staff AS s
INNER JOIN
(address AS a INNER JOIN city 
	AS ci INNER JOIN country 
	AS co ON ci.country_id = co.country_id ON a.city_id = ci.city_id)
	ON s.address_id = a.address_id
INNER JOIN inventory AS inv ON s.store_id = inv.store_id
INNER JOIN customer AS cus ON s.store_id = cus.store_id
GROUP BY s.staff_id

--9

--10
SELECT co.country,
	COUNT(re.rental_id) AS rental_count,
	DENSE_RANK() OVER (ORDER BY co.country) AS 'DENSE_RANK'
FROM rental re
	INNER JOIN customer cu 
		ON (re.customer_id = cu.customer_id)
	INNER JOIN address a 
		ON (cu.address_id = a.address_id )
	INNER JOIN city ci
		ON (a.city_id = ci.city_id)
	INNER JOIN country co
		ON (ci.country_id = co.country_id)
	INNER JOIN inventory i
		ON (re.inventory_id = i.inventory_id)
	INNER JOIN film_actor fa
		ON (i.film_id = fa.film_id)
	INNER JOIN actor ac
		ON (fa.actor_id = ac.actor_id)
WHERE ac.first_name = 'GINA' AND ac.last_name = 'DEGENERES'
GROUP BY co.country
ORDER BY rental_count DESC


